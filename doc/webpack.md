## 前端工程化

- webpack 全家桶
- rollup 实战和手写
- vite3 全家桶
- 手写 umi4 框架
- 手写cli

## webpack 的编译流程

1. 初始化参数，从配置文件和 shell 语句中读取合并参数，并得到最终的配置对象
2. 用上一步得到的参数初始化 `Compiler` 对象
3. 加载所有配置的插件
4. 执行`Compiler`对象的`run`方法开始执行编译
5. 根据配置文件中的`entry`配置项找到入口文件
6. 从入口文件出发，调用所有配置的规则，比如说 loader 对模块进行编译
7. 再找出此模块的依赖的模块，在递归本步骤找到依赖的模块进行编译
8. 等把所有的模块编译完成后，根据模块之间的依赖关系，组装成一个个包含多个模块的 chunk
9. 再把各个代码块 chunk 转换成一个一个的文件加入到输出列表
10. 在确定输出内容之后，会根据配置的输出路径和文件名，把文件内容写到文件系统里

> 在此过程中，webpack[基于事件流] 会在特定的时间点广播出特定的事件，我们可以写自己的插件监听感兴趣的事件，执行特定的逻辑

### Compiler

`Compiler` 对象代表了完整的 webpack 环境配置。这个对象在启动 webpack 时被一次性建立，并配置好所有可操作的设置，包括 options,loader 和 plugin。当在 webpack 环境中应用一个插件时，插件将收到此 compiler 对象的引用。可以使用它来访问 webpack 的主环境

`compilation` 对象代表了一次资源版本的构建。当运行 webpack 开发环境中间件时，每当检测到一个文件变化，就会创建一个新的 compilation, 从而生成一组新的编译资源。一个 compilation 对象表现了当前的模块资源、编译生成资源、变化的文件、以及被跟踪依赖的状态信息。compilation 对象也提供了很多关键时机的回调，以供插件做自定义处理时选择使用
